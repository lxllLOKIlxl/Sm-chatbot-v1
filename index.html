<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sm-chatbot-v1</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .message-bubble {
            max-width: 80%;
            padding: 12px;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            line-height: 1.5;
        }
    </style>
</head>
<body class="bg-gray-100">

<div class="flex flex-col h-[80vh] w-full max-w-2xl bg-white rounded-xl shadow-2xl overflow-hidden">
    <div class="flex items-center p-4 bg-purple-600 text-white shadow-lg">
        <div class="h-10 w-10 rounded-full bg-purple-400 flex items-center justify-center mr-3">
            <svg class="h-6 w-6 text-white" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
            </svg>
        </div>
        <h1 class="text-xl font-semibold">Бот підтримки</h1>
    </div>

    <div id="chat-history" class="flex-1 p-6 space-y-4 overflow-y-auto"></div>

    <div class="p-4 bg-gray-100 border-t border-gray-200">
        <form id="chat-form" class="flex items-center space-x-3">
            <input id="user-input" type="text" placeholder="Напишіть своє повідомлення..." class="flex-1 p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-purple-500 transition duration-200">
            <button type="submit" class="bg-purple-600 text-white p-3 rounded-lg font-semibold hover:bg-purple-700 transition duration-200 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2">
                Відправити
            </button>
        </form>
    </div>
</div>

<script>
    const chatForm = document.getElementById('chat-form');
    const userInput = document.getElementById('user-input');
    const chatHistory = document.getElementById('chat-history');

    function displayMessage(text, isUser) {
        const messageContainer = document.createElement('div');
        const bubble = document.createElement('div');
        messageContainer.className = isUser ? 'flex justify-end' : 'flex justify-start';
        bubble.className = isUser ? 'message-bubble bg-purple-500 text-white' : 'message-bubble bg-gray-200 text-gray-800';
        bubble.textContent = text;
        messageContainer.appendChild(bubble);
        chatHistory.appendChild(messageContainer);
        chatHistory.scrollTop = chatHistory.scrollHeight;
    }

    async function getBotResponse(message) {
        try {
            const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Authorization': 'Bearer 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',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    model: 'model: 'openai/gpt-3.5-turbo',
                    messages: [
                        { role: 'system', content: 'Ти — український чат-бот підтримки. Відповідай коротко, чітко і ввічливо.' },
                        { role: 'user', content: message }
                    ]
                })
            });
            const data = await response.json();
            return data.choices?.[0]?.message?.content || 'Немає відповіді.';
        } catch (error) {
            return 'Помилка з’єднання з AI.';
        }
    }

    chatForm.addEventListener('submit', async (event) => {
        event.preventDefault();
        const message = userInput.value.trim();
        if (message === '') {
            const messageBox = document.createElement('div');
            messageBox.textContent = 'Поле повідомлення не може бути порожнім!';
            messageBox.className = 'fixed bottom-4 left-1/2 transform -translate-x-1/2 px-4 py-2 bg-red-500 text-white rounded-lg shadow-lg z-50';
            document.body.appendChild(messageBox);
            setTimeout(() => messageBox.remove(), 2000);
            return;
        }
        displayMessage(message, true);
        const botResponse = await getBotResponse(message);
        displayMessage(botResponse, false);
        userInput.value = '';
    });

    window.onload = function() {
        displayMessage('Привіт! Я твій віртуальний помічник. Чим можу бути корисним?', false);
    };
</script>

</body>
</html>
